From 658807f49b5c2fc4ba8b317c644811fd84184cf9 Mon Sep 17 00:00:00 2001
From: Felix Palmen <zirias@FreeBSD.org>
Date: Thu, 29 Jun 2023 13:12:52 +0200
Subject: [PATCH] lang/rust: Allow build with LibreSSL 3.7.3

---
 .../patch-vendor_openssl-sys_build_main.rs    | 20 +++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 lang/rust/files/patch-vendor_openssl-sys_build_main.rs

diff --git a/lang/rust/files/patch-vendor_openssl-sys_build_main.rs b/lang/rust/files/patch-vendor_openssl-sys_build_main.rs
new file mode 100644
index 000000000000..a1e4308c46f9
--- /dev/null
+++ b/lang/rust/files/patch-vendor_openssl-sys_build_main.rs
@@ -0,0 +1,20 @@
+--- vendor/openssl-sys/build/main.rs.orig	2023-06-29 11:05:22 UTC
++++ vendor/openssl-sys/build/main.rs
+@@ -284,6 +284,8 @@ See rust-openssl documentation for more information:
+             (3, 6, _) => ('3', '6', 'x'),
+             (3, 7, 0) => ('3', '7', '0'),
+             (3, 7, 1) => ('3', '7', '1'),
++            (3, 7, 2) => ('3', '7', '2'),
++            (3, 8, 2) => ('3', '8', '2'),
+             _ => version_error(),
+         };
+ 
+@@ -326,7 +328,7 @@ fn version_error() -> ! {
+         "
+ 
+ This crate is only compatible with OpenSSL (version 1.0.1 through 1.1.1, or 3.0.0), or LibreSSL 2.5
+-through 3.7.1, but a different version of OpenSSL was found. The build is now aborting
++through 3.7.3, but a different version of OpenSSL was found. The build is now aborting
+ due to this version mismatch.
+ 
+ "
-- 
2.41.0

